# IoT.md
## IoTの機能
### Thingレジストリ
- デバイスレジストリ
	- デバイスの管理、検索が容易になる。
	- デバイスの名前、クライアントID,属性情報
- Thingタイプ
	- オプション。デバイスをThingタイプでまとめる。属性を定義できる。

## セキュリティ
- MQTT+TLS相互認証,AWS認証+HTTPS
- IoTポリシーとして、どのリソースにどのような権限でアクセスするのか設定可能
- 各フェーズいずれにもセキュリティが入る。

### X.509 デバイス証明書登録のパターン
1.ワンクリック証明書
	- デバイス証明書とプライベートキーをデバイスにダウンロードする。
2.CSRを元にIoTが証明書を生成
	- デバイス側でCSRを作成。IoTに登録することで証明書が作られる。
	- そのデバイス証明書をデバイス側にダウンロード
3.独自証明書を作成し、IoTに登録
	- CA証明書をIoTへ登録
	- 中間CA証明書をIoTに登録する。
4.ジャストインタイム登録
	- 「3」の登録時にLambdaを実行したり、ポリシーを適用したり。
	- 自動登録の有効化

## デバイスゲートウェイ
- デバイスゲートウェイ
- メッセージブローカー
	- ライフサイクルイベント
		- Connect/Disconnectイベント

## ルールエンジン
- メッセージ処理と他のAWSサービスとの連携
- メッセージのペイロードからSQLでデータ選択が可能
- S3,Lambda,DynamoDB,Kinesisへのデータ送信など。

## Thingシャドウ、Thingシャドウサービス
- デバイスの現在の状態情報の保存と取得
	- デバイスがオフラインでも管理ができる。
- デバイスの状態を変更できる
	- 例えば、エンジン:OFF→エンジン:ONに変更したり。
	- オンラインになった時に反映。
